
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;php&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="php">php</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Buscar">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introducao" class="toc-h1 toc-link" data-title="introducao">Introdução</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#como-ler-este-documento" class="toc-h2 toc-link" data-title="como-ler-este-documento">Como ler este documento?</a>
                  </li>
                  <li>
                    <a href="#qual-documento-fiscal-voce-precisa-emitir" class="toc-h2 toc-link" data-title="qual-documento-fiscal-voce-precisa-emitir">Qual documento fiscal você precisa emitir?</a>
                  </li>
                  <li>
                    <a href="#visao-geral-do-processo-de-emissao-de-um-documento" class="toc-h2 toc-link" data-title="visao-geral-do-processo-de-emissao-de-um-documento">Visão geral do processo de emissão de um documento</a>
                  </li>
                  <li>
                    <a href="#autenticacao" class="toc-h2 toc-link" data-title="autenticacao">Autenticação</a>
                  </li>
                  <li>
                    <a href="#referencia" class="toc-h2 toc-link" data-title="referencia">Referência</a>
                  </li>
                  <li>
                    <a href="#ambiente" class="toc-h2 toc-link" data-title="ambiente">Ambiente</a>
                  </li>
                  <li>
                    <a href="#padrao-rest" class="toc-h2 toc-link" data-title="padrao-rest">Padrão REST</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#authentication" class="toc-h1 toc-link" data-title="authentication">Authentication</a>
          </li>
          <li>
            <a href="#kittens" class="toc-h1 toc-link" data-title="kittens">Kittens</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-all-kittens" class="toc-h2 toc-link" data-title="get-all-kittens">Get All Kittens</a>
                  </li>
                  <li>
                    <a href="#get-a-specific-kitten" class="toc-h2 toc-link" data-title="get-a-specific-kitten">Get a Specific Kitten</a>
                  </li>
                  <li>
                    <a href="#delete-a-specific-kitten" class="toc-h2 toc-link" data-title="delete-a-specific-kitten">Delete a Specific Kitten</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="errors">Errors</a>
          </li>
          <li>
            <a href="#nfe" class="toc-h1 toc-link" data-title="nfe">NFe</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#urls" class="toc-h2 toc-link" data-title="urls">URLs</a>
                  </li>
                  <li>
                    <a href="#envio" class="toc-h2 toc-link" data-title="envio">Envio</a>
                  </li>
                  <li>
                    <a href="#consulta" class="toc-h2 toc-link" data-title="consulta">Consulta</a>
                  </li>
                  <li>
                    <a href="#cancelamento" class="toc-h2 toc-link" data-title="cancelamento">Cancelamento</a>
                  </li>
                  <li>
                    <a href="#carta-de-correcao-eletronica" class="toc-h2 toc-link" data-title="carta-de-correcao-eletronica">Carta de Correção Eletrônica</a>
                  </li>
                  <li>
                    <a href="#reenvio-de-email" class="toc-h2 toc-link" data-title="reenvio-de-email">Reenvio de email</a>
                  </li>
                  <li>
                    <a href="#inutilizacao" class="toc-h2 toc-link" data-title="inutilizacao">Inutilização</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#nfce" class="toc-h1 toc-link" data-title="nfce">NFCe</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#urls-formato-de-dados-e-retorno" class="toc-h2 toc-link" data-title="urls-formato-de-dados-e-retorno">URLs, formato de dados e retorno</a>
                  </li>
                  <li>
                    <a href="#envio" class="toc-h2 toc-link" data-title="envio">Envio</a>
                  </li>
                  <li>
                    <a href="#consulta" class="toc-h2 toc-link" data-title="consulta">Consulta</a>
                  </li>
                  <li>
                    <a href="#cancelamento" class="toc-h2 toc-link" data-title="cancelamento">Cancelamento</a>
                  </li>
                  <li>
                    <a href="#inutilizacao" class="toc-h2 toc-link" data-title="inutilizacao">Inutilização</a>
                  </li>
                  <li>
                    <a href="#campos-obrigatorios-de-uma-nfe" class="toc-h2 toc-link" data-title="campos-obrigatorios-de-uma-nfe">Campos obrigatórios de uma NFe</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#backups-nfe-e-nfce" class="toc-h1 toc-link" data-title="backups-nfe-e-nfce">Backups (NFe e NFCe)</a>
          </li>
          <li>
            <a href="#nfse" class="toc-h1 toc-link" data-title="nfse">NFSe</a>
          </li>
          <li>
            <a href="#manifestacao" class="toc-h1 toc-link" data-title="manifestacao">Manifestação</a>
          </li>
          <li>
            <a href="#gatilhos" class="toc-h1 toc-link" data-title="gatilhos">Gatilhos</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#criacao-de-um-novo-gatilho" class="toc-h2 toc-link" data-title="criacao-de-um-novo-gatilho">Criação de um novo gatilho</a>
                  </li>
                  <li>
                    <a href="#consulta-de-gatilhos" class="toc-h2 toc-link" data-title="consulta-de-gatilhos">Consulta de gatilhos</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#revenda" class="toc-h1 toc-link" data-title="revenda">Revenda</a>
          </li>
          <li>
            <a href="#limite-de-requisicoes" class="toc-h1 toc-link" data-title="limite-de-requisicoes">Limite de requisições</a>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='#'>Sign Up for a Developer Key</a></li>
            <li><a href='https://github.com/lord/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introducao'>Introdução</h1>
<aside class="warning">Esta é a API para a versão mais recente (v2) usando NFe 4.00. Para acessar a documentação da API v1 <a href='https://focusnfe.com.br/api/doc'>clique aqui</a>.</aside>

<p>A API do Focus NFe permite que você emita ou consulte documentos fiscais (NFe, NFSe, NFCe) a partir do seu sistema, seja qual for a tecnologia que ele utilize através da geração de dados em um formato simplificado, sem a necessidade de gerara a assinatura digital destes documentos. A API ainda gerencia toda a comunicação com os servidores da SEFAZ de cada estado ou com os servidores da prefeitura, no caso de NFSe.</p>

<p>Através desta documentação deverá ser possível fazer a integração com a API do Focus NFe, caso alguma dúvida permaneça você pode entrar em contato com o suporte especializado através do e-mail suporte@acras.com.br.</p>
<h2 id='como-ler-este-documento'>Como ler este documento?</h2>
<p>Você deverá ler primeiramente a introdução, em seguida, a seção sobre o documento que você irá emitir (<a href="#nfe">NFe</a>, <a href="#nfce">NFCe</a> ou <a href="#nfse">NFSe</a>).</p>

<p>Caso você emita NFe ou NFCe, você deverá ler também sobre os <a href="#backups-nfe-e-nfce">backups</a>.</p>

<p>Caso você emita NFe ou NFSe, você poderá ler também sobre os <a href="#gatilhos">gatilhos</a>. O uso de gatilhos no sistema é opcional.</p>

<p>Caso você tenha interesse em obter as notas emitidas contra a sua empresa, leia a seção de <a href="#manifestacao">manifestação</a>.</p>

<p>Se sua empresa irá administrar vários clientes que emitem notas, pode ser interessante você ler sobre a seção de <a href="#revenda">revenda</a>.</p>
<h2 id='qual-documento-fiscal-voce-precisa-emitir'>Qual documento fiscal você precisa emitir?</h2>
<p>Dependendo da atividade da sua empresa você deverá emitir um ou mais destes documentos que irão representar frente ao governo qualquer operação com mercadoria ou serviços:</p>

<ul>
<li>NFe - Nota Fiscal Eletrônica. Utilizado para indústrias, distribuidores em geral ou empresas que vendem para clientes fora de seu estado. Neste caso é aceitável uma nota demorar vários minutos para ser autorizada. Existe um padrão nacional. O documento é de competência do estado.</li>
<li>NFCe - Nota Fiscal ao Consumidor Eletrônica. Utilizado para empresas de varejo, que trabalham diretamente com o consumidor final. Neste caso há a preocupação da nota ser emitida em poucos segundos. Existe um padrão nacional. O documento é de competência do estado.</li>
<li>NFSe - Nota Fiscal de Serviços Eletrônica. Utilizado para a maioria dos prestadores de serviços. É aceitável a nota demorar vários minutos para ser autorizada. Esta nota é de competência da prefeitura. Existe uma recomendação nacional que cada prefeitura implementa como bem entender.</li>
<li>CTe - Conhecimento de Transporte Eletrônico. Usado para prestadores de serviços de transporte. Existe um padrão nacional. Documento de competência do estado.</li>
</ul>

<p>Existe algumas exceções no país, por exemplo Brasília pode utilizar NFe para serviços e Manaus utiliza NFCe em alguns casos para notas de serviços. Na dúvida, consulte o contador da sua empresa.</p>
<h2 id='visao-geral-do-processo-de-emissao-de-um-documento'>Visão geral do processo de emissão de um documento</h2><h2 id='autenticacao'>Autenticação</h2>
<p>A autenticação é feita através de um token. Ao habilitar a API para sua empresa forneceremos uma string secreta e única que será usada para efetuar todas as operações. A autenticação poderá ser feita usando o método HTTP Basic Auth (saiba mais em <a href="https://en.wikipedia.org/wiki/Basic_access_authentication">https://en.wikipedia.org/wiki/Basic_access_authentication</a>) fornecendo o token como nome de usuário e deixando a senha em branco.</p>

<p>Caso não seja possível utilizar método HTTP Basic Auth você pode também enviar sempre o parâmetro “token” informando o seu token de acesso. Porém nós recomendamos o uso de HTTP Basic Auth pois isto aumenta a segurança impedindo a gravação do token em históricos do navegador, logs de acesso, etc.</p>
<h2 id='referencia'>Referência</h2>
<p>A referência é a forma que utilizamos para identificar a sua emissão em nossa API, por isso, ela deve ser única para cada token de acesso que você receba. A referência pode ser alfanumérica, contudo, não são permitidos caracteres especiais. É comum a utilização do identificador da tabela em banco de dados que representa uma nota fiscal no seu sistema.</p>

<p>Uma referência pode ser reutilizada caso ocorra erro na autorização. Mas uma vez que a nota seja autorizada (mesmo que posteriormente cancelada), a referência usada não poderá mais ser usada em outro envio.</p>
<h2 id='ambiente'>Ambiente</h2>
<p>A API do Focus NFe oferece dois ambientes para emissão de notas: homologação e produção.</p>

<p><strong>Homologação</strong></p>

<p>O ambiente de homologação serve para envio de notas fiscais com a finalidade de teste. As notas emitidas aqui não possuem validade fiscal/tributária.</p>

<p><strong>Produção</strong>
Este é o ambiente com validade fiscal e tributária, pois isso, recomendamos que utilize este ambiente apenas quando for iniciar o processo de envio de notas válidas.</p>

<p>O endereço dos servidores são os seguintes:</p>

<p>Homologação: <code>http://homologacao.acrasnfe.acras.com.br</code> (note que não é utilizado SSL).</p>

<p>Produção: <code>https://api.focusnfe.com.br</code> (obrigatório o uso de SSL).</p>

<p>Ao longo desta documentação todas as URLs serão mostradas para ambiente de produção. Para usar o ambiente de homologação basta alterar o endereço do servidor.</p>
<h2 id='padrao-rest'>Padrão REST</h2>
<p>A API utiliza o padrão de arquitetura REST <a href="https://pt.wikipedia.org/wiki/REST">https://pt.wikipedia.org/wiki/REST</a>. Neste padrão, são utilizados verbos ou métodos HTTP (GET, POST, DELETE) em conjunto com determinados recursos disponíveis através de uma URL para representar uma determinada ação. Por exemplo, o verbo GET é usado para representar algum tipo de visualização dos dados de um dado recurso, e o verbo POST é usado para criar um novo recurso e o verbo DELETE representa uma exclusão.</p>

<p>Abaixo alguns exemplos de requisições:</p>

<table><thead>
<tr>
<th>Método</th>
<th>URL (recurso)</th>
<th>Ação</th>
</tr>
</thead><tbody>
<tr>
<td>POST</td>
<td>/v2/nfe?ref=REFERENCIA</td>
<td>Cria uma nota fiscal e a envia para processamento.</td>
</tr>
<tr>
<td>GET</td>
<td>/v2/nfe/REFERENCIA</td>
<td>Consulta a nota fiscal com a referência informada e o seu status de processamento</td>
</tr>
<tr>
<td>DELETE</td>
<td>/v2/nfe/REFERENCIA</td>
<td>Cancela uma nota fiscal com a referência informada</td>
</tr>
</tbody></table>

<p>A API utiliza o formato JSON para transferência de dados.</p>

<p>Sempre que é feita uma chamada HTTP é devolvido um código de retorno. Este código irá informar também se a requisição foi aceita ou se ocorreu algum erro, da seguinte forma:</p>

<ul>
<li>Códigos que iniciam com “2” representam ação que foi completada com sucesso, por exemplo: 200, 201.</li>
<li>Códigos que inicial com “4” ou &quot;5&quot; representam algum erro na requisição, por exemplo: 404, 402, etc.</li>
</ul>

<p>Abaixo listamos os códigos HTTP que nossa API pode devolver:</p>

<table><thead>
<tr>
<th>Código HTTP</th>
<th>Significado</th>
<th>Explicação</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>Ok</td>
<td>Este código é devolvido quando uma consulta resulta em sucesso.</td>
</tr>
<tr>
<td>201</td>
<td>Criado</td>
<td>Este código é devolvido quando uma requisição é aceita para processamento.</td>
</tr>
<tr>
<td>400</td>
<td>Requisição inválida</td>
<td>Este erro é devolvido quando falta alguma informação na requisição. Por exemplo quando falta algum parâmetro obrigatório.</td>
</tr>
<tr>
<td>403</td>
<td>Permissão negada</td>
<td>Este erro é devolvido quando ocorre algum problema de permissão envolvendo o token de acesso.</td>
</tr>
<tr>
<td>404</td>
<td>Não encontrado</td>
<td>Este erro é devolvido quando não é encontrado algum recurso que é pesquisado.</td>
</tr>
<tr>
<td>415</td>
<td>Mídia inválida</td>
<td>Este erro é devolvido quando não é reconhecido o formato JSON enviado, devido a alguma falha de sintaxe.</td>
</tr>
<tr>
<td>429</td>
<td>Muitas requisições</td>
<td>Você ultrapassou o limite de requisições por minuto. Veja o <a href="#limite-de-requisicoes">limite de requisições</a></td>
</tr>
<tr>
<td>429</td>
<td>Muitas requisições</td>
<td>Você ultrapassou o limite de requisições por minuto. Veja o <a href="#limite-de-requisicoes">limite de requisições</a></td>
</tr>
<tr>
<td>500</td>
<td>Erro interno do servidor</td>
<td>Ocorreu algum erro inesperado. Contate o suporte técnico.</td>
</tr>
</tbody></table>

<p>Note que se o código HTTP devolvido for de sucesso não implica que uma nota tenha sido autorizada com sucesso. Por exemplo, você pode enviar uma nota fiscal para autorização, nossa API devolver o status 201 (criado) (pois não havia nenhum erro aparente na nota fiscal) porém ao ser processada pela SEFAZ ou prefeitura verificou-se que a data de emissão estava muito atrasada. Ou seja, os códigos HTTP são utilizados para verificar se a transação está ok no nível de comunicação da sua aplicação com a nossa API (e não com o SEFAZ).</p>
<h1 id='authentication'>Authentication</h1>
<blockquote>
<p>To authorize, use this code:</p>
</blockquote>
<pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'kittn'</span>

<span class="n">api</span> <span class="o">=</span> <span class="no">Kittn</span><span class="o">::</span><span class="no">APIClient</span><span class="p">.</span><span class="nf">authorize!</span><span class="p">(</span><span class="s1">'meowmeowmeow'</span><span class="p">)</span>
</code></pre><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">kittn</span>

<span class="n">api</span> <span class="o">=</span> <span class="n">kittn</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="s">'meowmeowmeow'</span><span class="p">)</span>
</code></pre><pre class="highlight shell tab-shell"><code><span class="c"># With shell, you can just pass the correct header with each request</span>
curl <span class="s2">"api_endpoint_here"</span>
  -H <span class="s2">"Authorization: meowmeowmeow"</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">kittn</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'kittn'</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">api</span> <span class="o">=</span> <span class="nx">kittn</span><span class="p">.</span><span class="nx">authorize</span><span class="p">(</span><span class="s1">'meowmeowmeow'</span><span class="p">);</span>
</code></pre>
<blockquote>
<p>Make sure to replace <code>meowmeowmeow</code> with your API key.</p>
</blockquote>

<p>Kittn uses API keys to allow access to the API. You can register a new Kittn API key at our <a href="http://example.com/developers">developer portal</a>.</p>

<p>Kittn expects for the API key to be included in all API requests to the server in a header that looks like the following:</p>

<p><code>Authorization: meowmeowmeow</code></p>

<aside class="notice">
You must replace <code>meowmeowmeow</code> with your personal API key.
</aside>
<h1 id='kittens'>Kittens</h1><h2 id='get-all-kittens'>Get All Kittens</h2><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'kittn'</span>

<span class="n">api</span> <span class="o">=</span> <span class="no">Kittn</span><span class="o">::</span><span class="no">APIClient</span><span class="p">.</span><span class="nf">authorize!</span><span class="p">(</span><span class="s1">'meowmeowmeow'</span><span class="p">)</span>
<span class="n">api</span><span class="p">.</span><span class="nf">kittens</span><span class="p">.</span><span class="nf">get</span>
</code></pre><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">kittn</span>

<span class="n">api</span> <span class="o">=</span> <span class="n">kittn</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="s">'meowmeowmeow'</span><span class="p">)</span>
<span class="n">api</span><span class="o">.</span><span class="n">kittens</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</code></pre><pre class="highlight shell tab-shell"><code>curl <span class="s2">"http://example.com/api/kittens"</span>
  -H <span class="s2">"Authorization: meowmeowmeow"</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">kittn</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'kittn'</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">api</span> <span class="o">=</span> <span class="nx">kittn</span><span class="p">.</span><span class="nx">authorize</span><span class="p">(</span><span class="s1">'meowmeowmeow'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">kittens</span> <span class="o">=</span> <span class="nx">api</span><span class="p">.</span><span class="nx">kittens</span><span class="p">.</span><span class="nx">get</span><span class="p">();</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Fluffums"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"breed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"calico"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"fluffiness"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cuteness"</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Max"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"breed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unknown"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"fluffiness"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cuteness"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<p>This endpoint retrieves all kittens.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET http://example.com/api/kittens</code></p>
<h3 id='query-parameters'>Query Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>include_cats</td>
<td>false</td>
<td>If set to true, the result will also include cats.</td>
</tr>
<tr>
<td>available</td>
<td>true</td>
<td>If set to false, the result will include kittens that have already been adopted.</td>
</tr>
</tbody></table>

<aside class="success">
Remember — a happy kitten is an authenticated kitten!
</aside>
<h2 id='get-a-specific-kitten'>Get a Specific Kitten</h2><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'kittn'</span>

<span class="n">api</span> <span class="o">=</span> <span class="no">Kittn</span><span class="o">::</span><span class="no">APIClient</span><span class="p">.</span><span class="nf">authorize!</span><span class="p">(</span><span class="s1">'meowmeowmeow'</span><span class="p">)</span>
<span class="n">api</span><span class="p">.</span><span class="nf">kittens</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">kittn</span>

<span class="n">api</span> <span class="o">=</span> <span class="n">kittn</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="s">'meowmeowmeow'</span><span class="p">)</span>
<span class="n">api</span><span class="o">.</span><span class="n">kittens</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre><pre class="highlight shell tab-shell"><code>curl <span class="s2">"http://example.com/api/kittens/2"</span>
  -H <span class="s2">"Authorization: meowmeowmeow"</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">kittn</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'kittn'</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">api</span> <span class="o">=</span> <span class="nx">kittn</span><span class="p">.</span><span class="nx">authorize</span><span class="p">(</span><span class="s1">'meowmeowmeow'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">max</span> <span class="o">=</span> <span class="nx">api</span><span class="p">.</span><span class="nx">kittens</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Max"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"breed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unknown"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"fluffiness"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
  </span><span class="s2">"cuteness"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint retrieves a specific kitten.</p>

<aside class="warning">Inside HTML code blocks like this one, you can't use Markdown, so use <code>&lt;code&gt;</code> blocks to denote code.</aside>
<h3 id='http-request-2'>HTTP Request</h3>
<p><code>GET http://example.com/kittens/&lt;ID&gt;</code></p>
<h3 id='url-parameters'>URL Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ID</td>
<td>The ID of the kitten to retrieve</td>
</tr>
</tbody></table>
<h2 id='delete-a-specific-kitten'>Delete a Specific Kitten</h2><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'kittn'</span>

<span class="n">api</span> <span class="o">=</span> <span class="no">Kittn</span><span class="o">::</span><span class="no">APIClient</span><span class="p">.</span><span class="nf">authorize!</span><span class="p">(</span><span class="s1">'meowmeowmeow'</span><span class="p">)</span>
<span class="n">api</span><span class="p">.</span><span class="nf">kittens</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">kittn</span>

<span class="n">api</span> <span class="o">=</span> <span class="n">kittn</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="s">'meowmeowmeow'</span><span class="p">)</span>
<span class="n">api</span><span class="o">.</span><span class="n">kittens</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre><pre class="highlight shell tab-shell"><code>curl <span class="s2">"http://example.com/api/kittens/2"</span>
  -X DELETE
  -H <span class="s2">"Authorization: meowmeowmeow"</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">kittn</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'kittn'</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">api</span> <span class="o">=</span> <span class="nx">kittn</span><span class="p">.</span><span class="nx">authorize</span><span class="p">(</span><span class="s1">'meowmeowmeow'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">max</span> <span class="o">=</span> <span class="nx">api</span><span class="p">.</span><span class="nx">kittens</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
  </span><span class="s2">"deleted"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">":("</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint deletes a specific kitten.</p>
<h3 id='http-request-3'>HTTP Request</h3>
<p><code>DELETE http://example.com/kittens/&lt;ID&gt;</code></p>
<h3 id='url-parameters-2'>URL Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ID</td>
<td>The ID of the kitten to delete</td>
</tr>
</tbody></table>
<h1 id='errors'>Errors</h1>
<aside class="notice">
This error section is stored in a separate file in <code>includes/_errors.md</code>. Slate allows you to optionally separate out your docs into many files...just save them to the <code>includes</code> folder and add them to the top of your <code>index.md</code>'s frontmatter. Files are included in the order listed.
</aside>

<p>The Kittn API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request -- Your request is invalid.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized -- Your API key is wrong.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden -- The kitten requested is hidden for administrators only.</td>
</tr>
<tr>
<td>404</td>
<td>Not Found -- The specified kitten could not be found.</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed -- You tried to access a kitten with an invalid method.</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable -- You requested a format that isn&#39;t json.</td>
</tr>
<tr>
<td>410</td>
<td>Gone -- The kitten requested has been removed from our servers.</td>
</tr>
<tr>
<td>418</td>
<td>I&#39;m a teapot.</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests -- You&#39;re requesting too many kittens! Slow down!</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error -- We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable -- We&#39;re temporarily offline for maintenance. Please try again later.</td>
</tr>
</tbody></table>
<h1 id='nfe'>NFe</h1>
<p>Através da API NFe é possível:</p>

<ul>
<li>Emitir NFe utilizando dados simplificados.</li>
<li>Cancelar NFe.</li>
<li>Consultar o status de NFe emitidas.</li>
<li>Encaminhar uma NFe por email</li>
<li>Emitir Carta de Correção.</li>
<li>Inutilizar uma faixa de numeração de NFe</li>
</ul>
<h2 id='urls'>URLs</h2>
<table><thead>
<tr>
<th>Método</th>
<th>URL (recurso)</th>
<th>Ação</th>
</tr>
</thead><tbody>
<tr>
<td>POST</td>
<td>/v2/nfe?ref=REFERENCIA</td>
<td>Cria uma nota fiscal e a envia para processamento.</td>
</tr>
<tr>
<td>GET</td>
<td>/v2/nfe/REFERENCIA</td>
<td>Consulta a nota fiscal com a referência informada e o seu status de processamento</td>
</tr>
<tr>
<td>DELETE</td>
<td>/v2/nfe/REFERENCIA</td>
<td>Cancela uma nota fiscal com a referência informada</td>
</tr>
<tr>
<td>POST</td>
<td>/v2/nfe/REFERENCIA/carta_correcao</td>
<td>Cria uma carta de correção para a nota fiscal com a referência informada.</td>
</tr>
<tr>
<td>POST</td>
<td>/v2/nfe/REFERENCIA/email</td>
<td>Envia um email com uma cópia da nota fiscal com a referência informada</td>
</tr>
<tr>
<td>POST</td>
<td>/v2/nfe/inutilizacao</td>
<td>Inutiliza uma numeração da nota fiscal</td>
</tr>
</tbody></table>
<h2 id='envio'>Envio</h2>
<p>Para enviar uma NFe utilize a URL abaixo, alterando o ambiente de produção para homologação, caso esteja emitindo notas de teste.</p>

<p>Envia uma NFe para autorização:</p>

<p><code>https://api.focusnfe.com.br/v2/nfe?ref=REFERENCIA</code></p>

<p>Utilize o comando HTTP POST para enviar a sua nota para nossa API. Envie como corpo do POST os dados em formato JSON da nota fiscal.</p>

<blockquote>
<blockquote>
<p>Abaixo um exemplo de dados de uma nota (usando a versão 4.00 da NFe):</p>
</blockquote>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"natureza_operacao"</span><span class="p">:</span><span class="s2">"Remessa"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"data_emissao"</span><span class="p">:</span><span class="s2">"2017-04-15"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"data_entrada_saida"</span><span class="p">:</span><span class="s2">"2017-04-15"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"tipo_documento"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"finalidade_emissao"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"cnpj_emitente"</span><span class="p">:</span><span class="s2">"SEU_CNPJ"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"nome_emitente"</span><span class="p">:</span><span class="s2">"Sua Raz</span><span class="se">\u</span><span class="s2">00e3o Social Ltda"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"nome_fantasia_emitente"</span><span class="p">:</span><span class="s2">"Fantasia do Emitente"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"logradouro_emitente"</span><span class="p">:</span><span class="s2">"Rua Quinze de Abril"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"numero_emitente"</span><span class="p">:</span><span class="mi">999</span><span class="p">,</span><span class="w">
  </span><span class="s2">"bairro_emitente"</span><span class="p">:</span><span class="s2">"Jd Paulistano"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"municipio_emitente"</span><span class="p">:</span><span class="s2">"S</span><span class="se">\u</span><span class="s2">00e3o Paulo"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"uf_emitente"</span><span class="p">:</span><span class="s2">"SP"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"cep_emitente"</span><span class="p">:</span><span class="s2">"01454-600"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"inscricao_estadual_emitente"</span><span class="p">:</span><span class="s2">"SUA_INSCRICAO_ESTADUAL"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"nome_destinatario"</span><span class="p">:</span><span class="s2">"NF-E EMITIDA EM AMBIENTE DE HOMOLOGACAO - SEM VALOR FISCAL"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"cpf_destinatario"</span><span class="p">:</span><span class="s2">"03055054911"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"inscricao_estadual_destinatario"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"telefone_destinatario"</span><span class="p">:</span><span class="mi">1196185555</span><span class="p">,</span><span class="w">
  </span><span class="s2">"logradouro_destinatario"</span><span class="p">:</span><span class="s2">"Rua S</span><span class="se">\u</span><span class="s2">00e3o Janu</span><span class="se">\u</span><span class="s2">00e1rio"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"numero_destinatario"</span><span class="p">:</span><span class="mi">99</span><span class="p">,</span><span class="w">
  </span><span class="s2">"bairro_destinatario"</span><span class="p">:</span><span class="s2">"Crespo"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"municipio_destinatario"</span><span class="p">:</span><span class="s2">"Manaus"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"uf_destinatario"</span><span class="p">:</span><span class="s2">"AM"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"pais_destinatario"</span><span class="p">:</span><span class="s2">"Brasil"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"cep_destinatario"</span><span class="p">:</span><span class="mi">69073178</span><span class="p">,</span><span class="w">
  </span><span class="s2">"valor_frete"</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"valor_seguro"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"valor_total"</span><span class="p">:</span><span class="mf">47.23</span><span class="p">,</span><span class="w">
  </span><span class="s2">"valor_produtos"</span><span class="p">:</span><span class="mf">47.23</span><span class="p">,</span><span class="w">
  </span><span class="s2">"modalidade_frete"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"numero_item"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="s2">"codigo_produto"</span><span class="p">:</span><span class="mi">1232</span><span class="p">,</span><span class="w">
      </span><span class="s2">"descricao"</span><span class="p">:</span><span class="s2">"Cartu00f5es de Visita"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"cfop"</span><span class="p">:</span><span class="mi">5923</span><span class="p">,</span><span class="w">
      </span><span class="s2">"unidade_comercial"</span><span class="p">:</span><span class="s2">"un"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"quantidade_comercial"</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span><span class="w">
      </span><span class="s2">"valor_unitario_comercial"</span><span class="p">:</span><span class="mf">0.4723</span><span class="p">,</span><span class="w">
      </span><span class="s2">"valor_unitario_tributavel"</span><span class="p">:</span><span class="mf">0.4723</span><span class="p">,</span><span class="w">
      </span><span class="s2">"unidade_tributavel"</span><span class="p">:</span><span class="s2">"un"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"codigo_ncm"</span><span class="p">:</span><span class="mi">49111090</span><span class="p">,</span><span class="w">
      </span><span class="s2">"quantidade_tributavel"</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span><span class="w">
      </span><span class="s2">"valor_bruto"</span><span class="p">:</span><span class="mf">47.23</span><span class="p">,</span><span class="w">
      </span><span class="s2">"icms_situacao_tributaria"</span><span class="p">:</span><span class="mi">41</span><span class="p">,</span><span class="w">
      </span><span class="s2">"icms_origem"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"pis_situacao_tributaria"</span><span class="p">:</span><span class="s2">"07"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"cofins_situacao_tributaria"</span><span class="p">:</span><span class="s2">"07"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="cm">/* Você deve definir isso globalmente para sua aplicação.
Para ambiente de produção utilize e a variável abaixo:
$server = "https://api.focusnfe.com.br"; */</span>
<span class="nv">$server</span> <span class="o">=</span> <span class="s2">"http://homologacao.acrasnfe.acras.com.br"</span><span class="p">;</span>
<span class="c1">// Substituir a variável, ref, pela sua identificação interna de nota.
</span><span class="nv">$ref</span> <span class="o">=</span> <span class="s2">"12345"</span><span class="p">;</span>
<span class="nv">$login</span> <span class="o">=</span> <span class="s2">"token_enviado_pelo_suporte"</span><span class="p">;</span>
<span class="nv">$password</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
<span class="nv">$nfe</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span>
  <span class="s2">"natureza_operacao"</span> <span class="o">=&gt;</span> <span class="s2">"Remessa"</span><span class="p">,</span>
  <span class="s2">"data_emissao"</span> <span class="o">=&gt;</span> <span class="s2">"2017-11-30T12:00:00"</span><span class="p">,</span>
  <span class="s2">"data_entrada_saida"</span> <span class="o">=&gt;</span> <span class="s2">"2017-11-3012:00:00"</span><span class="p">,</span>
  <span class="s2">"tipo_documento"</span> <span class="o">=&gt;</span> <span class="s2">"1"</span><span class="p">,</span>
  <span class="s2">"finalidade_emissao"</span> <span class="o">=&gt;</span> <span class="s2">"1"</span><span class="p">,</span>
  <span class="s2">"cnpj_emitente"</span> <span class="o">=&gt;</span> <span class="s2">"51916585000125"</span><span class="p">,</span>
  <span class="s2">"nome_emitente"</span> <span class="o">=&gt;</span> <span class="s2">"ACME LTDA"</span><span class="p">,</span>
  <span class="s2">"nome_fantasia_emitente"</span> <span class="o">=&gt;</span> <span class="s2">"ACME LTDA"</span><span class="p">,</span>
  <span class="s2">"logradouro_emitente"</span> <span class="o">=&gt;</span> <span class="s2">"R. Padre Natal Pigato"</span><span class="p">,</span>
  <span class="s2">"numero_emitente"</span> <span class="o">=&gt;</span> <span class="s2">"100"</span><span class="p">,</span>
  <span class="s2">"bairro_emitente"</span> <span class="o">=&gt;</span> <span class="s2">"Santa Felicidade"</span><span class="p">,</span>
  <span class="s2">"municipio_emitente"</span> <span class="o">=&gt;</span> <span class="s2">"Curitiba"</span><span class="p">,</span>
  <span class="s2">"uf_emitente"</span> <span class="o">=&gt;</span> <span class="s2">"PR"</span><span class="p">,</span>
  <span class="s2">"cep_emitente"</span> <span class="o">=&gt;</span> <span class="s2">"82320030"</span><span class="p">,</span>
  <span class="s2">"inscricao_estadual_emitente"</span> <span class="o">=&gt;</span> <span class="s2">"101942171617"</span><span class="p">,</span>
  <span class="s2">"nome_destinatario"</span> <span class="o">=&gt;</span> <span class="s2">"NF-E EMITIDA EM AMBIENTE DE HOMOLOGACAO - SEM VALOR FISCAL"</span><span class="p">,</span>
  <span class="s2">"cpf_destinatario"</span> <span class="o">=&gt;</span> <span class="s2">"51966818092"</span><span class="p">,</span>
  <span class="s2">"telefone_destinatario"</span> <span class="o">=&gt;</span> <span class="s2">"1196185555"</span><span class="p">,</span>
  <span class="s2">"logradouro_destinatario"</span> <span class="o">=&gt;</span> <span class="s2">"Rua S\u00e3o Janu\u00e1rio"</span><span class="p">,</span>
  <span class="s2">"numero_destinatario"</span> <span class="o">=&gt;</span> <span class="s2">"99"</span><span class="p">,</span>
  <span class="s2">"bairro_destinatario"</span> <span class="o">=&gt;</span> <span class="s2">"Crespo"</span><span class="p">,</span>
  <span class="s2">"municipio_destinatario"</span> <span class="o">=&gt;</span> <span class="s2">"Manaus"</span><span class="p">,</span>
  <span class="s2">"uf_destinatario"</span> <span class="o">=&gt;</span> <span class="s2">"AM"</span><span class="p">,</span>
  <span class="s2">"pais_destinatario"</span> <span class="o">=&gt;</span> <span class="s2">"Brasil"</span><span class="p">,</span>
  <span class="s2">"cep_destinatario"</span> <span class="o">=&gt;</span> <span class="s2">"69073178"</span><span class="p">,</span>
  <span class="s2">"valor_frete"</span> <span class="o">=&gt;</span> <span class="s2">"0.0"</span><span class="p">,</span>
  <span class="s2">"valor_seguro"</span> <span class="o">=&gt;</span> <span class="s2">"0"</span><span class="p">,</span>
  <span class="s2">"valor_total"</span> <span class="o">=&gt;</span> <span class="s2">"47.23"</span><span class="p">,</span>
  <span class="s2">"valor_produtos"</span> <span class="o">=&gt;</span> <span class="s2">"47.23"</span><span class="p">,</span>
  <span class="s2">"modalidade_frete"</span> <span class="o">=&gt;</span> <span class="s2">"0"</span><span class="p">,</span>
  <span class="s2">"items"</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span>
      <span class="s2">"numero_item"</span> <span class="o">=&gt;</span> <span class="s2">"1"</span><span class="p">,</span>
      <span class="s2">"codigo_produto"</span> <span class="o">=&gt;</span> <span class="s2">"1232"</span><span class="p">,</span>
      <span class="s2">"descricao"</span> <span class="o">=&gt;</span> <span class="s2">"Cartu00f5es de Visita"</span><span class="p">,</span>
      <span class="s2">"cfop"</span> <span class="o">=&gt;</span> <span class="s2">"6923"</span><span class="p">,</span>
      <span class="s2">"unidade_comercial"</span> <span class="o">=&gt;</span> <span class="s2">"un"</span><span class="p">,</span>
      <span class="s2">"quantidade_comercial"</span> <span class="o">=&gt;</span> <span class="s2">"100"</span><span class="p">,</span>
      <span class="s2">"valor_unitario_comercial"</span> <span class="o">=&gt;</span> <span class="s2">"0.4723"</span><span class="p">,</span>
      <span class="s2">"valor_unitario_tributavel"</span> <span class="o">=&gt;</span> <span class="s2">"0.4723"</span><span class="p">,</span>
      <span class="s2">"unidade_tributavel"</span> <span class="o">=&gt;</span> <span class="s2">"un"</span><span class="p">,</span>
      <span class="s2">"codigo_ncm"</span> <span class="o">=&gt;</span> <span class="s2">"49111090"</span><span class="p">,</span>
      <span class="s2">"quantidade_tributavel"</span> <span class="o">=&gt;</span> <span class="s2">"100"</span><span class="p">,</span>
      <span class="s2">"valor_bruto"</span> <span class="o">=&gt;</span> <span class="s2">"47.23"</span><span class="p">,</span>
      <span class="s2">"icms_situacao_tributaria"</span> <span class="o">=&gt;</span> <span class="s2">"400"</span><span class="p">,</span>
      <span class="s2">"icms_origem"</span> <span class="o">=&gt;</span> <span class="s2">"0"</span><span class="p">,</span>
      <span class="s2">"pis_situacao_tributaria"</span> <span class="o">=&gt;</span> <span class="s2">"07"</span><span class="p">,</span>
      <span class="s2">"cofins_situacao_tributaria"</span> <span class="o">=&gt;</span> <span class="s2">"07"</span>
    <span class="p">)</span>
  <span class="p">),</span>
<span class="p">);</span>
<span class="c1">// Inicia o processo de envio das informações usando o cURL.
</span><span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$server</span><span class="o">.</span><span class="s2">"/v2/nfe?ref="</span> <span class="o">.</span> <span class="nv">$ref</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POST</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$nfe</span><span class="p">));</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPAUTH</span><span class="p">,</span> <span class="nx">CURLAUTH_BASIC</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_USERPWD</span><span class="p">,</span> <span class="s2">"</span><span class="nv">$login</span><span class="s2">:</span><span class="nv">$password</span><span class="s2">"</span><span class="p">);</span>
<span class="nv">$body</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
<span class="nv">$http_code</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>
<span class="c1">// As próximas três linhas são um exemplo de como imprimir as informações de retorno da API.
</span><span class="k">print</span><span class="p">(</span><span class="nv">$http_code</span><span class="o">.</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">);</span>
<span class="k">print</span><span class="p">(</span><span class="nv">$body</span><span class="o">.</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">);</span>
<span class="k">print</span><span class="p">(</span><span class="s2">""</span><span class="p">);</span>
<span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre><h3 id='reenvio-automatico-em-contingencia'>Reenvio automático em contingência</h3>
<p>Caso nossa equipe de monitoramento detecte que o SEFAZ de algum estado esteja fora do ar as requisições são redirecionadas para o ambiente de contingência da SEFAZ do estado. É natural haver uma demora na SEFAZ em disponibilizar esse ambiente (eles realizam este processo manualmente) porém nossa API irá continuar tentando o reenvio até que seja possível, seja pela emissão normal ou em contingência. Isto é feito de forma transparente aos clientes da API.</p>

<p>Porém, pode ocorrer uma situação em que o SEFAZ do estado fique indisponível no meio do processo de emissão de uma NFe. Neste momento nós não temos como saber se a nota foi autorizada ou não, até que a SEFAZ volte a ficar disponível.</p>

<p>Quando isto ocorre nós não esperamos a SEFAZ do estado voltar e reenviamos assim que possível para o ambiente de contingência, autorizando a nota e evitando a espera para o cliente final. Isto tem como efeito colateral que pode ser que a nota original tenha sido autorizada. Nossa API irá automaticamente detectar esta situação e proceder com o cancelamento da tentativa anterior. Por consequência, será natural haver um “pulo” de numeração percebido pelo cliente final.</p>

<p>O sistema cliente da API pode acompanhar este processo de forma transparente, conforme descrito na seção “Consulta” deste manual.</p>
<h2 id='consulta'>Consulta</h2>
<p>Para consultar uma NFe utilize a URL abaixo, alterando o ambiente de produção para homologação, caso esteja emitindo notas de teste.</p>

<p>Consultar as informações de uma NFe:</p>

<p><code>https://api.focusnfe.com.br/v2/nfe/REFERENCIA</code></p>

<p>Utilize o comando HTTP GET para consultar a sua nota para nossa API.</p>
<pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="cm">/* Você deve definir isso globalmente para sua aplicação.
Para ambiente de produção utilize e a variável abaixo:
$server = "https://api.focusnfe.com.br"; */</span>
<span class="nv">$server</span> <span class="o">=</span> <span class="s2">"http://homologacao.acrasnfe.acras.com.br"</span><span class="p">;</span>
<span class="c1">// Substituir a variável, ref, pela sua identificação interna de nota.
</span><span class="nv">$ref</span> <span class="o">=</span> <span class="s2">"12345"</span><span class="p">;</span>
<span class="nv">$login</span> <span class="o">=</span> <span class="s2">"token_enviado_pelo_suporte"</span><span class="p">;</span>
<span class="nv">$password</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
<span class="c1">// Inicia o processo de envio das informações usando o cURL.
</span><span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$server</span><span class="o">.</span><span class="s2">"/v2/nfe/"</span> <span class="o">.</span> <span class="nv">$ref</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="k">array</span><span class="p">());</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPAUTH</span><span class="p">,</span> <span class="nx">CURLAUTH_BASIC</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_USERPWD</span><span class="p">,</span> <span class="s2">"</span><span class="nv">$login</span><span class="s2">:</span><span class="nv">$password</span><span class="s2">"</span><span class="p">);</span>
<span class="nv">$body</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
<span class="nv">$http_code</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>
<span class="c1">// As próximas três linhas são um exemplo de como imprimir as informações de retorno da API.
</span><span class="k">print</span><span class="p">(</span><span class="nv">$http_code</span><span class="o">.</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">);</span>
<span class="k">print</span><span class="p">(</span><span class="nv">$body</span><span class="o">.</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">);</span>
<span class="k">print</span><span class="p">(</span><span class="s2">""</span><span class="p">);</span>
<span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre>
<blockquote>
<p>Exemplo de resposta da consulta de NFe:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"autorizado"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"status_sefaz"</span><span class="p">:</span><span class="s2">"100"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"mensagem_sefaz"</span><span class="p">:</span><span class="s2">"Autorizado o uso da NF-e"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"cnpj_emitente"</span><span class="p">:</span><span class="s2">"SEU_CNPJ"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ref"</span><span class="p">:</span><span class="s2">"REFERENCIA"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"chave_nfe"</span><span class="p">:</span><span class="s2">"NFe41170777627353999172550010000003871980884091"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"numero"</span><span class="p">:</span><span class="s2">"387"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"serie"</span><span class="p">:</span><span class="s2">"1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"caminho_xml_nota_fiscal"</span><span class="p">:</span><span class="s2">"/arquivos/733530172/201704/XMLs/41170777627353999172550010000003871980884091-nfe.xml"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"caminho_danfe"</span><span class="p">:</span><span class="s2">"/arquivos/733530172/201704/DANFEs/41170777627353999172550010000003871980884091.pdf"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"caminho_xml_carta_correcao"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/arquivos/733530172/201704/XMLs/41170777627353999172550010000003871980884091-cce-01.xml"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"caminho_pdf_carta_correcao"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/notas_fiscais/NFe41170777627353999172550010000003871980884091/cartas_correcao/1.pdf"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"numero_carta_correcao"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Campos de retorno:</p>

<ul>
<li><strong>status</strong>: A situação da NFe, podendo ser:

<ul>
<li><strong>processando_autorizacao</strong>: A nota ainda está em processamento pela API. Você deverá aguardar o processamento pela SEFAZ.</li>
<li><strong>autorizado</strong>: A nota foi autorizada, neste caso é fornecido os dados completos da nota como chave e arquivos para download</li>
<li><strong>cancelado</strong>: O documento foi cancelado, neste caso é fornecido o caminho para download do XML de cancelamento (caminho_xml_cancelamento).</li>
<li><strong>erro_autorizacao</strong>: Houve um erro de autorização por parte da SEFAZ. A mensagem de erro você encontrará nos campos status_sefaz e mensagem_sefaz. É possível fazer o reenvio da nota com a mesma referência se ela estiver neste estado.</li>
<li><strong>denegado</strong>: O documento foi denegado. Uma SEFAZ pode denegar uma nota se houver algum erro cadastral nos dados do destinatário ou do emitente. A mensagem de erro você encontrará nos campos status_sefaz e mensagem_sefaz. Não é possível reenviar a nota caso este estado seja alcançado pois é gerado um número, série, chave de NFe e XML para esta nota. O XML deverá ser armazenado pelo mesmo período de uma nota autorizada ou cancelada.</li>
</ul></li>
<li><strong>status_sefaz</strong>: O status da nota na SEFAZ.</li>
<li><strong>mensagem_sefaz</strong>: Mensagem descritiva da SEFAZ detalhando o status.</li>
<li><strong>serie</strong>: A série da nota fiscal, caso ela tenha sido autorizada.</li>
<li><strong>numero</strong>: O número da nota fiscal, caso ela tenha sido autorizada.</li>
<li><strong>cnpj_emitente</strong>: O CNPJ emitente da nota fiscal (o CNPJ de sua empresa).</li>
<li><strong>ref</strong>:A referência da emissão.</li>
<li><strong>chave_nfe</strong>: A chave da NFe, caso ela tenha sido autorizada.</li>
<li><strong>caminho_xml_nota_fiscal</strong>: caso a nota tenha sido autorizada, retorna o caminho para download do XML.</li>
<li><strong>caminho_danfe</strong>: caso a nota tenha sido autorizada retorna o caminho para download do DANFe.</li>
<li><strong>caminho_xml_carta_correcao</strong>: caso tenha sido emitida alguma carta de correção, aqui aparecerá o caminho para fazer o download do XML.</li>
<li><strong>caminho_pdf_carta_correcao</strong>: caso tenha sido emitida alguma carta de correção, aqui aparecerá o caminho para fazer o download do PDF da carta.</li>
<li><strong>numero_carta_correcao</strong>: o número da carta de correção, caso tenha sido emitida.</li>
<li><strong>caminho_xml_cancelamento</strong>: Caso a nota esteja cancelada, é fornecido o caminho para fazer o download do XML de cancelamento.</li>
</ul>

<p>Caso na requisição seja passado o parâmetro <code>completa=1</code> será informado mais dois campos:</p>

<ul>
<li><strong>requisicao_nota_fiscal</strong>: Inclui os dados completos da requisição da nota fiscal, da mesma forma que constam no XML da nota.</li>
<li><strong>protocolo_nota_fiscal</strong>: Inclui os dados completos do protocolo devolvido pela SEFAZ.</li>
</ul>
<h3 id='reenvio-automatico-em-contingencia-algumas-consideracoes'>Reenvio Automático em Contingência – algumas considerações</h3>
<p>Quando houver uma tentativa anterior de emissão, conforme descrito na seção “Reenvio automático em contingência”. A API irá devolver a chave <code>tentativa_anterior</code> que irá conter os seguintes campos:</p>

<ul>
<li>status: autorizado, processando_autorizacao ou cancelado. A API irá automaticamente proceder com o cancelamento quando necessário</li>
<li>serie</li>
<li>numero</li>
<li>chave_nfe</li>
<li>caminho_xml_nota_fiscal</li>
<li>caminho_xml_cancelamento</li>
</ul>
<h2 id='cancelamento'>Cancelamento</h2>
<p>Para cancelar uma NFe, basta fazer uma requisição à URL abaixo, alterando o ambiente de produção para homologação, caso esteja emitindo notas de teste.</p>

<p>Cancelar uma NFe já autorizada:</p>

<p><code>https://api.focusnfe.com.br/v2/nfe/REFERENCIA</code></p>

<p>Utilize o comando HTTP DELETE para cancelar a sua nota para nossa API. Este método é síncrono, ou seja, a comunicação com a SEFAZ será feita imediatamente e devolvida a resposta na mesma requisição.</p>

<p>O parâmetros de cancelamento deverão ser enviados da seguinte forma:</p>

<ul>
<li><strong>justificativa</strong>: Justificativa do cancelamento. Deverá conter de 15 a 255 caracteres.</li>
</ul>
<pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="cm">/* Você deve definir isso globalmente para sua aplicação.
Para ambiente de produção utilize e a variável abaixo:
$server = "https://api.focusnfe.com.br"; */</span>
<span class="nv">$server</span> <span class="o">=</span> <span class="s2">"http://homologacao.acrasnfe.acras.com.br"</span><span class="p">;</span>
<span class="c1">// Substituir a variável, ref, pela sua identificação interna de nota.
</span><span class="nv">$ref</span> <span class="o">=</span> <span class="s2">"12345"</span><span class="p">;</span>
<span class="nv">$login</span> <span class="o">=</span> <span class="s2">"token_enviado_pelo_suporte"</span><span class="p">;</span>
<span class="nv">$password</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
<span class="nv">$justificativa</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span><span class="s2">"justificativa"</span> <span class="o">=&gt;</span> <span class="s2">"Teste de cancelamento de nota"</span><span class="p">);</span>
<span class="c1">// Inicia o processo de envio das informações usando o cURL.
</span><span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$server</span> <span class="o">.</span> <span class="s2">"/v2/nfe/"</span> <span class="o">.</span> <span class="nv">$ref</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_CUSTOMREQUEST</span><span class="p">,</span> <span class="s2">"DELETE"</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$justificativa</span><span class="p">));</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPAUTH</span><span class="p">,</span> <span class="nx">CURLAUTH_BASIC</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_USERPWD</span><span class="p">,</span> <span class="s2">"</span><span class="nv">$login</span><span class="s2">:</span><span class="nv">$password</span><span class="s2">"</span><span class="p">);</span>
<span class="nv">$body</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>
<span class="c1">// As próximas três linhas são um exemplo de como imprimir as informações de retorno da API.
</span><span class="k">print</span><span class="p">(</span><span class="nv">$http_code</span><span class="o">.</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">);</span>
<span class="k">print</span><span class="p">(</span><span class="nv">$body</span><span class="o">.</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">);</span>
<span class="k">print</span><span class="p">(</span><span class="s2">""</span><span class="p">);</span>
<span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre>
<p>A API irá em seguida devolver os seguintes campos:</p>

<ul>
<li><strong>status</strong>: cancelado, se a nota pode ser cancelada, ou erro_cancelamento, se houve algum erro ao cancelar a nota.</li>
<li><strong>status_sefaz</strong>: O status do cancelamento na SEFAZ.</li>
<li><strong>mensagem_sefaz</strong>: Mensagem descritiva da SEFAZ detalhando o status.</li>
<li><strong>caminho_xml_cancelamento</strong>: Caso a nota tenha sido cancelada, será informado aqui o caminho para download do XML de cancelamento.</li>
</ul>
<h3 id='prazo-de-cancelamento'>Prazo de cancelamento</h3>
<p>A NFe poderá ser cancelada em até 24 horas após a emissão. No entanto, alguns estados podem permitir um prazo maior para o cancelamento.</p>
<h2 id='carta-de-correcao-eletronica'>Carta de Correção Eletrônica</h2>
<p>Uma Carta de Correção eletrônica (CCe) pode ser utilizada para corrigir eventuais erros na NFe. As seguintes informações <strong>não podem ser corrigidas</strong>:</p>

<ul>
<li>As variáveis que determinam o valor do imposto tais como: base de cálculo, alíquota, diferença de preço, quantidade, valor da operação ou da prestação;</li>
<li>A correção de dados cadastrais que implique mudança do remetente ou do destinatário;</li>
<li>A data de emissão ou de saída.</li>
</ul>

<p>Não existe prazo especificado para emissão de cartas de correção. É possível enviar até 20 correções diferentes, sendo que será válido sempre a última correção enviada.</p>
<h3 id='emissao-de-cce'>Emissão de CCe</h3>
<p><code>https://api.focusnfe.com.br/v2/nfe/REFERENCIA/carta_correcao</code></p>

<p>Utilize o comando HTTP POST para enviar a sua nota para nossa API. Este método é <strong>síncrono</strong>, ou seja, a comunicação com a SEFAZ será feita imediatamente e devolvida a resposta na mesma requisição.</p>

<p>O parâmetros da carta de correção deverão ser enviados da seguinte forma:</p>

<ul>
<li><strong>correcao</strong>: Texto da carta de correção. Deverá conter de 15 a 255 caracteres.</li>
<li><strong>data_evento</strong>: Campo opcional. Data do evento da carta de correção. Se não informado será usado a data atual</li>
</ul>
<pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="cm">/* Você deve definir isso globalmente para sua aplicação.
Para ambiente de produção utilize e a variável abaixo:
$server = "https://api.focusnfe.com.br"; */</span>
<span class="nv">$server</span> <span class="o">=</span> <span class="s2">"http://homologacao.acrasnfe.acras.com.br"</span><span class="p">;</span>
<span class="c1">// Substituir a variável, ref, pela sua identificação interna de nota.
</span><span class="nv">$ref</span> <span class="o">=</span> <span class="s2">"12345"</span><span class="p">;</span>
<span class="nv">$login</span> <span class="o">=</span> <span class="s2">"token_enviado_pelo_suporte"</span><span class="p">;</span>
<span class="nv">$password</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
<span class="nv">$correcao</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span>
  <span class="s2">"correcao"</span> <span class="o">=&gt;</span> <span class="s2">"Teste de carta de correcao"</span><span class="p">,</span>
<span class="p">);</span>
<span class="c1">// Inicia o processo de envio das informações usando o cURL.
</span><span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$server</span> <span class="o">.</span> <span class="s2">"/v2/nfe/"</span> <span class="o">.</span> <span class="nv">$ref</span>  <span class="o">.</span> <span class="s2">"/carta_correcao"</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POST</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$correcao</span><span class="p">));</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPAUTH</span><span class="p">,</span> <span class="nx">CURLAUTH_BASIC</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_USERPWD</span><span class="p">,</span> <span class="s2">"</span><span class="nv">$login</span><span class="s2">:</span><span class="nv">$password</span><span class="s2">"</span><span class="p">);</span>
<span class="nv">$body</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
<span class="nv">$http_code</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>
<span class="c1">// As próximas três linhas são um exemplo de como imprimir as informações de retorno da API.
</span><span class="k">print</span><span class="p">(</span><span class="nv">$http_code</span><span class="o">.</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">);</span>
<span class="k">print</span><span class="p">(</span><span class="nv">$body</span><span class="o">.</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">);</span>
<span class="k">print</span><span class="p">(</span><span class="s2">""</span><span class="p">);</span>
<span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre>
<p>A API irá em seguida devolver os seguintes campos:</p>

<ul>
<li><strong>status</strong>: autorizado, se a carta de correção foi aceita pela SEFAZ, ou erro_autorizacao, se houve algum erro ao cancelar a nota.</li>
<li><strong>status_sefaz</strong>: O status da carta de correção na SEFAZ.</li>
<li><strong>mensagem_sefaz</strong>: Mensagem descritiva da SEFAZ detalhando o status.</li>
<li><strong>caminho_xml_carta_correcao</strong>: Informa o caminho do XML da carta de correção, caso ela tenha sido autorizada.</li>
<li><strong>caminho_pdf_carta_correcao</strong>: Informa o caminho do PDF da carta de correção, caso ela tenha sido autorizada.</li>
<li><strong>numero_carta_correcao</strong>: Informa o número da carta de correção, caso ela tenha sido autorizada.</li>
</ul>

<p>Para uma mesma nota fiscal é possível enviar mais de uma carta de correção, até o limite de 20 correções, sendo que a última sempre substitui a anterior.</p>
<h2 id='reenvio-de-email'>Reenvio de email</h2><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="cm">/* Você deve definir isso globalmente para sua aplicação
Para ambiente de produção utilize e a variável abaixo:
$server = "https://api.focusnfe.com.br"; */</span>
<span class="nv">$server</span> <span class="o">=</span> <span class="s2">"http://homologacao.acrasnfe.acras.com.br"</span><span class="p">;</span>
<span class="c1">// Substituir a variável, ref, pela sua identificação interna de nota.
</span><span class="nv">$ref</span> <span class="o">=</span> <span class="s2">"12345"</span><span class="p">;</span>
<span class="nv">$login</span> <span class="o">=</span> <span class="s2">"token_enviado_pelo_suporte"</span><span class="p">;</span>
<span class="nv">$password</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
<span class="nv">$email</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span>
  <span class="s2">"emails"</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
    <span class="s2">"email@email.com"</span>
    <span class="p">)</span>
  <span class="p">);</span>
<span class="c1">// Inicia o processo de envio das informações usando o cURL.
</span><span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$server</span><span class="o">.</span><span class="s2">"/v2/nfe/"</span> <span class="o">.</span> <span class="nv">$ref</span> <span class="o">.</span> <span class="s2">"/email"</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POST</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$email</span><span class="p">));</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPAUTH</span><span class="p">,</span> <span class="nx">CURLAUTH_BASIC</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_USERPWD</span><span class="p">,</span> <span class="s2">"</span><span class="nv">$login</span><span class="s2">:</span><span class="nv">$password</span><span class="s2">"</span><span class="p">);</span>
<span class="nv">$body</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
<span class="nv">$http_code</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>
<span class="c1">// As próximas três linhas são um exemplo de como imprimir as informações de retorno da API.
</span><span class="k">print</span><span class="p">(</span><span class="nv">$http_code</span><span class="o">.</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">);</span>
<span class="k">print</span><span class="p">(</span><span class="nv">$body</span><span class="o">.</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">);</span>
<span class="k">print</span><span class="p">(</span><span class="s2">""</span><span class="p">);</span>
<span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre>
<p>Para cada nota autorizada, cancelada ou que tenha sido emitida uma carta de correção o destinatário da nota é notificado via email. Porém eventualmente pode ser necessário enviar a nota fiscal para outras pessoas ou mesmo reenviar o email para o mesmo destinatário.</p>

<p>Para enviar um ou mais emails:</p>

<p><code>https://api.focusnfe.com.br/v2/nfe/REFERENCIA/email</code></p>

<p>Utilize o comando HTTP POST para enviar os emails. Esta operação aceita apenas um parâmetro:</p>

<ul>
<li><strong>emails</strong>: Array com uma lista de emails que deverão receber uma cópia da nota. Limitado a 10 emails por vez.</li>
</ul>

<p>A API imediatamente devolve a requisição com a confirmação dos emails. Os emails serão enviados em segundo plano, por isso pode levar alguns minutos até que eles cheguem à caixa postal.</p>
<h2 id='inutilizacao'>Inutilização</h2>
<p>Em uma situação normal você não precisará informar ao SEFAZ a inutilização de um número da NFe, pois a API controla automaticamente a numeração das notas. Porém, se por alguma situação específica for necessário a inutilização de alguma faixa de números você poderá chamar as seguintes operações:</p>

<p>Envio de inutilização de faixa de numeração:</p>

<p><code>https://api.focusnfe.com.br/v2/nfe/inutilizacao</code></p>

<p>Utilize o comando HTTP POST para enviar a sua inutilização para nossa API. Este método é <strong>síncrono</strong>, ou seja, a comunicação com a SEFAZ será feita imediatamente e devolvida a resposta na mesma requisição.</p>

<p>A inutilização precisa dos seguintes parâmetros obrigatórios:</p>

<ul>
<li><strong>cnpj</strong>: CNPJ da empresa emitente</li>
<li><strong>serie</strong>: Série da numeração da NFe que terá uma faixa de numeração inutilizada</li>
<li><strong>numero_inicial</strong>: Número inicial a ser inutilizado</li>
<li><strong>numero_final</strong>: Número final a ser inutilizado</li>
<li><strong>justificativa</strong>: Justificativa da inutilização (mínimo 15 caracteres)</li>
</ul>
<pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="cm">/* Você deve definir isso globalmente para sua aplicação.
Para ambiente de produção utilize e a variável abaixo:
$server = "https://api.focusnfe.com.br"; */</span>
<span class="nv">$server</span> <span class="o">=</span> <span class="s2">"http://homologacao.acrasnfe.acras.com.br"</span><span class="p">;</span>
<span class="c1">// Substituir a variável, ref, pela sua identificação interna de nota.
</span><span class="nv">$login</span> <span class="o">=</span> <span class="s2">"token_enviado_pelo_suporte"</span><span class="p">;</span>
<span class="nv">$password</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
<span class="nv">$inutiliza</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span>
  <span class="s2">"cnpj"</span> <span class="o">=&gt;</span> <span class="s2">"51916585000125"</span><span class="p">,</span>
  <span class="s2">"serie"</span> <span class="o">=&gt;</span> <span class="s2">"1"</span><span class="p">,</span>
  <span class="s2">"numero_inicial"</span> <span class="o">=&gt;</span> <span class="s2">"7"</span><span class="p">,</span>
  <span class="s2">"numero_final"</span> <span class="o">=&gt;</span> <span class="s2">"9"</span><span class="p">,</span>
  <span class="s2">"justificativa"</span> <span class="o">=&gt;</span> <span class="s2">"Teste de inutilizacao denota"</span>  
<span class="p">);</span>
<span class="c1">// Inicia o processo de envio das informações usando o cURL.
</span><span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$server</span><span class="o">.</span><span class="s2">"/v2/nfe/inutilizacao"</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POST</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$inutiliza</span><span class="p">));</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPAUTH</span><span class="p">,</span> <span class="nx">CURLAUTH_BASIC</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_USERPWD</span><span class="p">,</span> <span class="s2">"</span><span class="nv">$login</span><span class="s2">:</span><span class="nv">$password</span><span class="s2">"</span><span class="p">);</span>
<span class="nv">$body</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
<span class="nv">$http_code</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>
<span class="c1">// As próximas três linhas são um exemplo de como imprimir as informações de retorno da API.
</span><span class="k">print</span><span class="p">(</span><span class="nv">$http_code</span><span class="o">.</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">);</span>
<span class="k">print</span><span class="p">(</span><span class="nv">$body</span><span class="o">.</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">);</span>
<span class="k">print</span><span class="p">(</span><span class="s2">""</span><span class="p">);</span>
<span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre>
<p>A API irá enviar uma resposta com os seguintes campos:</p>

<ul>
<li><strong>status</strong>: autorizado, se a inutilização foi aceita pela SEFAZ, ou erro_autorizacao, se houve algum erro ao inutilizar os números.</li>
<li><strong>status_sefaz</strong>: O status da carta de correção na SEFAZ.</li>
<li><strong>mensagem_sefaz</strong>: Mensagem descritiva da SEFAZ detalhando o status.</li>
<li><strong>serie</strong>: Série da numeração da NFe que terá uma faixa de numeração inutilizada</li>
<li><strong>numero_inicial</strong>: Número inicial a ser inutilizado</li>
<li><strong>numero_final</strong>: Número final a ser inutilizado</li>
<li><strong>caminho_xml</strong>: Caminho do XML para download caso a inutilização tenha sido autorizada pela SEFAZ.</li>
</ul>
<h1 id='nfce'>NFCe</h1><h2 id='urls-formato-de-dados-e-retorno'>URLs, formato de dados e retorno</h2><h2 id='envio'>Envio</h2><h2 id='consulta'>Consulta</h2><h2 id='cancelamento'>Cancelamento</h2><h2 id='inutilizacao'>Inutilização</h2><h2 id='campos-obrigatorios-de-uma-nfe'>Campos obrigatórios de uma NFe</h2><h1 id='backups-nfe-e-nfce'>Backups (NFe e NFCe)</h1><h1 id='nfse'>NFSe</h1><h1 id='manifestacao'>Manifestação</h1><h1 id='gatilhos'>Gatilhos</h1><h2 id='criacao-de-um-novo-gatilho'>Criação de um novo gatilho</h2><h2 id='consulta-de-gatilhos'>Consulta de gatilhos</h2><h1 id='revenda'>Revenda</h1><h1 id='limite-de-requisicoes'>Limite de requisições</h1>
      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="php">php</a>
          </div>
      </div>
    </div>
  </body>
</html>
